function moveCloud(){var t=this.x<-cloudSize,o=this.x>2*this.w+cloudSize;(t||o)&&(this.y=(this.h/2-20-this.h/87.5-10)*Math.random()-10,this.speed=Math.random()*(cloudSpeedDef-cloudSpeedMin)+cloudSpeedMin,t?this.x=this.w+cloudSize:this.x=-cloudSize),this.x+=this.speed*cloudSpeed}function renderCloud(){ctx.shadowBlur=7,ctx.shadowColor="black",ctx.font=cloudSize+"px FontAwesome",ctx.globalAlpha="0.7",ctx.fillStyle="#ffffff",ctx.textAlign="center",ctx.fillText("",this.x-cloudSize/2,this.y),ctx.shadowBlur=0,ctx.globalAlpha="1"}function Cloud(t,o,e,c,r){this.x=t,this.y=o,this.w=c,this.h=r,this.speed=e,this.update=moveCloud,this.render=renderCloud}function initRender(){clouds=[];for(var t=0;t<cloudCnt;t++)clouds.push(new Cloud(Math.random()*w,(h/2-20-h/87.5-10)*Math.random()-10,Math.random()*(cloudSpeedDef-cloudSpeedMin)+cloudSpeedMin,w,h));lastpx=w/50/2}function animate(t){pause||requestAnimationFrame(animate);var o=lastTime?(t-lastTime)/1e3:0;lastTime=t,o=Math.min(.1,o),world.step(fixedDeltaTime,o,maxSubSteps),tutorialm?rendertut():render()}function lerp(t,o,e){return(1-e)*t+e*o}function componentToHex(t){var o=t.toString(16);return 1==o.length?"0"+o:o}function rgbToHex(t,o,e){return"#"+componentToHex(t)+componentToHex(o)+componentToHex(e)}function hexToRgb(t){var o=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return o?{r:parseInt(o[1],16),g:parseInt(o[2],16),b:parseInt(o[3],16)}:null}function render(){var t=pogo.frame.body.position[0];t>secwidth,t-w/50/2>secwidth&&(removeSection(sectionA),removeSection(sectionB),sectionA=changenum(sectionB,0,1),sectionB=changenum(generateSection(),1,0),pogo.frame.body.position[0]-=secwidth,pogo.stick.body.position[0]-=secwidth,addSection(sectionA),addSection(sectionB),score+=secwidth),t<w/50/2&&secnum>2&&(removeSection(sectionA),removeSection(sectionB),secnum-=2,sectionB=changenum(sectionA,1,0),sectionA=generateSection(),pogo.frame.body.position[0]+=secwidth,pogo.stick.body.position[0]+=secwidth,addSection(sectionA),addSection(sectionB),score-=secwidth),pogo.frame.body.position[0]<0&&(gameOver=!0,leftplay=!1,pogo.frame.body.position[0]=Math.max(pogo.frame.body.position[0],-2),pogo.frame.body.position[1]=Math.max(pogo.frame.body.position[1],-5)),ctx.clearRect(0,0,w,h),colorful?ctx.fillStyle=color.sky:ctx.fillStyle="#FFFFFF",ctx.fillRect(0,0,w,h),ctx.fill();for(var o=50*(Math.max(pogo.frame.body.position[0],w/50/2)+xscroll)%secwidth,e=0;e<clouds.length;e++)clouds[e].x-=o;var c=yscroll;t>=w/50/2&&(xscroll=-pogo.frame.body.position[0]),v=pogo.frame.body.position[1]-yscroll,Math.abs(v)>.35?lerpval=.015:lerpval=.01,v<-.2&&(lerpval=.0325),yscroll=v*lerpval+yscroll;var r=distToTime(score+pogo.frame.body.position[0]-w/50/2),l=r*Math.PI-Math.PI;ctx.font="100px FontAwesome",ctx.fillStyle="#ffff00",ctx.textAlign="center",ctx.fillText("",Math.cos(l)*h/2+w/2,Math.sin(l)*h/2+50*yscroll+5*h/9),ctx.fillStyle="#ddddff",ctx.textAlign="center",ctx.fillText("",Math.cos(l+Math.PI)*h/2+w/2,Math.sin(l+Math.PI)*h/2+50*yscroll+5*h/9);var i=hexToRgb(color.skynight),n=hexToRgb(color.skyday),a=(r+.5)%2,s=n,d=i;if(a>1){var x=s;s=d,d=x}var f=Math.round(lerp(s.r,d.r,1-a%1)),u=Math.round(lerp(s.g,d.g,1-a%1)),d=Math.round(lerp(s.b,d.b,1-a%1));color.sky=rgbToHex(f,u,d);var p=color.sky,g=.025;if(r>2&&r%2<1-g&&(color.sky="#222222"),r%2>2-g){s=hexToRgb(color.sky),d=hexToRgb("#222222");var b=1-1*(2-r%2)/g,f=Math.round(lerp(s.r,d.r,b)),u=Math.round(lerp(s.g,d.g,b)),d=Math.round(lerp(s.b,d.b,b));color.sky=rgbToHex(f,u,d)}if(r>2&&r%2>1-g){d=hexToRgb(color.sky),s=hexToRgb("#222222");var b=1-1*(1-r%2)/g,f=Math.round(lerp(s.r,d.r,b)),u=Math.round(lerp(s.g,d.g,b)),d=Math.round(lerp(s.b,d.b,b));color.sky=rgbToHex(f,u,d)}if((r>2&&r%2>1||r<2)&&r%2<2-g&&(color.sky=p,color.ground=colordef.ground),r>2&&r%2<=1&&(color.ground="#222222"),r%2>2-g){s=hexToRgb(colordef.ground),d=hexToRgb("#222222");var b=1-1*(2-r%2)/g,f=Math.round(lerp(s.r,d.r,b)),u=Math.round(lerp(s.g,d.g,b)),d=Math.round(lerp(s.b,d.b,b));color.ground=rgbToHex(f,u,d)}if(r>2&&r%2>1-g){d=hexToRgb(colordef.ground),s=hexToRgb("#555555");var b=1-1*(1-r%2)/g,f=Math.round(lerp(s.r,d.r,b)),u=Math.round(lerp(s.g,d.g,b)),d=Math.round(lerp(s.b,d.b,b));color.ground=rgbToHex(f,u,d)}r>2&&r%2>1&&r%2<2-g&&(color.ground=colordef.ground),ctx.save(),ctx.translate(w/2,h/2),ctx.scale(50,-50);for(var e=0;e<clouds.length;e++)clouds[e].y+=50*(yscroll-c);ctx.translate(xscroll,-yscroll),ctx.strokeStyle="#000000",drawpogo();var y=-1,m=-1;ctx.beginPath(),ctx.moveTo(y,-h/50*3/4);for(var t=-xscroll,M=sectionA.d.slice(0,-1).concat(sectionB.d),e=0;e<M.length;e++){var S=2*e;if(S>=t-w/50/2-1&&ctx.lineTo(y+S,m+M[e]),S>t+w/50/2+2)break}ctx.lineTo(y+2*M.length-2,-h/50*3/4),ctx.closePath(),ctx.fillStyle=color.ground,colorful&&ctx.fill(),ctx.stroke();var T=null!=sectionA.h1,k=null!=sectionB.h1;if(ctx.fillStyle="#555555",T){ctx.beginPath();var A=sectionA.h1.body.position,P=sectionA.h1verts;ctx.moveTo(P[0][0]+A[0],P[0][1]+A[1]);for(var e=1;e<P.length-1;e++){var S=2*e;ctx.lineTo(A[0]+P[e][0],A[1]+P[e][1])}ctx.lineTo(P[P.length-1][0]+A[0],P[P.length-1][1]+A[1]),ctx.closePath(),colorful&&ctx.fill(),ctx.stroke()}if(k){ctx.beginPath();var A=sectionB.h1.body.position,P=sectionB.h1verts;ctx.moveTo(P[0][0]+A[0],P[0][1]+A[1]);for(var e=1;e<P.length-1;e++){var S=2*e;ctx.lineTo(A[0]+P[e][0],A[1]+P[e][1])}ctx.lineTo(P[P.length-1][0]+A[0],P[P.length-1][1]+A[1]),ctx.closePath(),colorful&&ctx.fill(),ctx.stroke()}ctx.restore();for(var e=0;e<clouds.length;e++)clouds[e].update(),clouds[e].render();ctx.save(),ctx.translate(w/2,h/2),ctx.scale(50,-50),ctx.translate(xscroll,-yscroll),ctx.strokeStyle="#000000",drawObstacles1(sectionA),drawObstacles1(sectionB),ctx.restore();var B=canvas.getBoundingClientRect();if(ctx.save(),fixedjoy&&!nojoystick){var C=Math.round((jloc.x-B.left)/(B.right-B.left)*canvas.width),I=Math.round((jloc.y-B.top)/(B.bottom-B.top)*canvas.height);ctx.beginPath(),ctx.arc(C,I,50,0,2*Math.PI,!1),ctx.globalAlpha=.5,ctx.fillStyle="#555555",ctx.fill(),ctx.beginPath(),ctx.arc(C,I,10,0,2*Math.PI,!1),ctx.globalAlpha=.7,ctx.fillStyle="#AAAAAA",ctx.fill()}if(ctx.restore(),mousedrag&&!nojoystick){var R=Math.round((lastmouse.x-B.left)/(B.right-B.left)*canvas.width),H=Math.round((lastmouse.y-B.top)/(B.bottom-B.top)*canvas.height),F=Math.round((currentmouse.clientX-B.left)/(B.right-B.left)*canvas.width),O=Math.round((currentmouse.clientY-B.top)/(B.bottom-B.top)*canvas.height);ctx.beginPath();var z=ctx.lineWidth;ctx.lineWidth=2,ctx.strokeStyle="#999999",ctx.moveTo(R,H),ctx.lineTo(F,O),ctx.stroke(),ctx.beginPath(),ctx.arc(F,O,4,0,2*Math.PI,!1),ctx.fillStyle="#999999",ctx.stroke(),ctx.fill(),ctx.lineWidth=z}ctx.font="20px Comic Sans MS",ctx.fillStyle="#555555",ctx.textAlign="center";var D=Math.floor((-xscroll-(r>2&&r%2<=1?4:0))%secwidth%(2*rarity));if(ctx.fillText("Next obstacle: "+(2*rarity-D),100,h-20),ctx.font="20px Comic Sans MS",ctx.fillStyle="#000000",ctx.textAlign="left",ctx.fillText("Level/Half-Days: "+r,0,60),gameOver){ctx.font="30px Comic Sans MS",ctx.fillStyle="red",ctx.textAlign="center",pendingquit||(endscore=score+Math.round(pogo.frame.body.position[0])-Math.floor(w/50/2),newtopscore=!1,endscore>topscore&&(topscore=endscore,newtopscore=!0,document.cookie="topscore="+endscore+"; expires=Tue, 19 Jan 2038 03:14:07 UTC"),pendingquit=!0,setTimeout(function(){return leftplay?void(leftplay=!1):(gameOver=!1,pendingquit=!1,void initgame())},3e3));var j="";newtopscore&&(j="New High Score!\n"),ctx.fillText(j+"Score: "+endscore,canvas.width/2,canvas.height/2-40)}else ctx.font="16px Comic Sans MS",ctx.fillStyle="black",ctx.textAlign="left",ctx.fillText("High Score: "+topscore,10,20),ctx.fillText("Score: "+(score-Math.floor(w/50/2)+Math.round(pogo.frame.body.position[0])),10,36)}function getCookie(t){for(var o=t+"=",e=document.cookie.split(";"),c=0;c<e.length;c++){for(var r=e[c];" "==r.charAt(0);)r=r.substring(1);if(0==r.indexOf(o))return r.substring(o.length,r.length)}return""}function drawObstacles(){for(var t=w/50/2,e=t-1,c=-xscroll,r=Math.floor((c+e)/(2*rarity)),l=0;l<obstacles.length;l++)o=obstacles[l],Math.abs(o.position[0]-c)<=t&&(ctx.beginPath(),ctx.arc(o.position[0],o.position[1],.5,0,2*Math.PI,!1),ctx.stroke());canvas_arrow(c+e-.3,obstacles[r].position[1],c+e+.5,obstacles[r].position[1]),ctx.strokeStyle="#000000"}function drawpogo(){ctx.fillStyle=color.stick,drawbox(pogo.stick),colorful&&ctx.fill(),ctx.fillStyle=color.body,drawbox(pogo.frame),colorful&&ctx.fill()}function drawbox(t){ctx.beginPath();var o=t.body.interpolatedPosition[0],e=t.body.interpolatedPosition[1];ctx.save(),ctx.translate(o,e),ctx.rotate(t.body.angle),ctx.rect(-t.shape.width/2,-t.shape.height/2,t.shape.width,t.shape.height),ctx.stroke(),ctx.restore()}function drawObstacles1(t){for(var e=t.h.body.position[0]!=-1,c=w/50/2,r=c-1,l=-xscroll,i=Math.floor((l+r)/(2*rarity)),n=0;n<t.o.length;n++)o=t.o[n],Math.abs(o.position[0]-l)<=c&&(ctx.beginPath(),ctx.arc(o.position[0],o.position[1],.5,0,2*Math.PI,!1),ctx.stroke());try{if(!e){var a=sectionA.o.concat(sectionB.o);canvas_arrow(l+r-.3,a[i].position[1],l+r+.5,a[i].position[1]),ctx.strokeStyle="#000000"}}catch(s){return}}function canvas_arrow(t,o,e,c){var r=.5,l=Math.atan2(c-o,e-t);ctx.beginPath(),ctx.moveTo(t,o),ctx.lineTo(e,c),ctx.lineTo(e-r*Math.cos(l-Math.PI/6),c-r*Math.sin(l-Math.PI/6)),ctx.moveTo(e,c),ctx.lineTo(e-r*Math.cos(l+Math.PI/6),c-r*Math.sin(l+Math.PI/6)),ctx.stroke()}var canvas,ctx,w,h,colorful=!0,colordef={sky:"#4d79ff",skyday:"#4d79ff",skynight:"#241c52",ground:"#00b300",body:"#ed00ed",stick:"#ff66ff"},color={sky:"#4d79ff",skyday:"#4d79ff",skynight:"#241c52",ground:"#00b300",body:"#ed00ed",stick:"#ff66ff"},cloudSpeed=1,cloudSize=100,cloudSpeedDef=1.5,cloudSpeedMin=.2,cloudCnt=5,clouds=[];speed=300;var lastTime,maxSubSteps=5,fixedDeltaTime=1/speed,xscroll=0,yscroll=0,endscore=0,newtopscore=!1;